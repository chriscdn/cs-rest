!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios")):"function"==typeof define&&define.amd?define(["exports","axios"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CSREST={},e.axios)}(this,(function(e,t){"use strict";var s={AssocType:-18,BooleanType:5,ClassType:9,DapiNodeType:-72,DapiSessionType:-74,DapiStreamType:-68,DapiVersionType:-69,DateType:-7,DynamicType:-127,ErrorType:1,FileType:-107,FrameType:10,IntegerType:2,JavaObjectType:-42,ListType:-2,LongType:-8,ObjectType:-128,ObjRefType:3,RealType:-4,RecArrayType:-110,RecordType:-109,ScriptType:-3,SocketType:-102,StringType:-1,UAPIType:-196,UndefinedType:0,VoidType:8,WAPIWorkType:-75},r={createFormData:()=>new FormData},n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o="Expected a function",i="__lodash_hash_undefined__",a=1/0,u="[object Function]",c="[object GeneratorFunction]",p="[object Symbol]",d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/,h=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,y=/\\(\\)?/g,_=/^\[object .+?Constructor\]$/,m="object"==typeof n&&n&&n.Object===Object&&n,v="object"==typeof self&&self&&self.Object===Object&&self,b=m||v||Function("return this")();var g,w=Array.prototype,T=Function.prototype,j=Object.prototype,$=b["__core-js_shared__"],x=(g=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",O=T.toString,F=j.hasOwnProperty,S=j.toString,k=RegExp("^"+O.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=b.Symbol,R=w.splice,B=H(b,"Map"),D=H(Object,"create"),E=P?P.prototype:void 0,N=E?E.toString:void 0;function V(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function U(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function q(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function C(e,t){for(var s,r,n=e.length;n--;)if((s=e[n][0])===(r=t)||s!=s&&r!=r)return n;return-1}function A(e,t){var s;t=function(e,t){if(W(e))return!1;var s=typeof e;if("number"==s||"symbol"==s||"boolean"==s||null==e||Y(e))return!0;return l.test(e)||!d.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:W(s=t)?s:G(s);for(var r=0,n=t.length;null!=e&&r<n;)e=e[L(t[r++])];return r&&r==n?e:void 0}function I(e){if(!M(e)||(t=e,x&&x in t))return!1;var t,s=function(e){var t=M(e)?S.call(e):"";return t==u||t==c}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?k:_;return s.test(function(e){if(null!=e){try{return O.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function Q(e,t){var s,r,n=e.__data__;return("string"==(r=typeof(s=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==s:null===s)?n["string"==typeof t?"string":"hash"]:n.map}function H(e,t){var s=function(e,t){return null==e?void 0:e[t]}(e,t);return I(s)?s:void 0}V.prototype.clear=function(){this.__data__=D?D(null):{}},V.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},V.prototype.get=function(e){var t=this.__data__;if(D){var s=t[e];return s===i?void 0:s}return F.call(t,e)?t[e]:void 0},V.prototype.has=function(e){var t=this.__data__;return D?void 0!==t[e]:F.call(t,e)},V.prototype.set=function(e,t){return this.__data__[e]=D&&void 0===t?i:t,this},U.prototype.clear=function(){this.__data__=[]},U.prototype.delete=function(e){var t=this.__data__,s=C(t,e);return!(s<0)&&(s==t.length-1?t.pop():R.call(t,s,1),!0)},U.prototype.get=function(e){var t=this.__data__,s=C(t,e);return s<0?void 0:t[s][1]},U.prototype.has=function(e){return C(this.__data__,e)>-1},U.prototype.set=function(e,t){var s=this.__data__,r=C(s,e);return r<0?s.push([e,t]):s[r][1]=t,this},q.prototype.clear=function(){this.__data__={hash:new V,map:new(B||U),string:new V}},q.prototype.delete=function(e){return Q(this,e).delete(e)},q.prototype.get=function(e){return Q(this,e).get(e)},q.prototype.has=function(e){return Q(this,e).has(e)},q.prototype.set=function(e,t){return Q(this,e).set(e,t),this};var G=J((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(Y(e))return N?N.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}(t);var s=[];return h.test(e)&&s.push(""),e.replace(f,(function(e,t,r,n){s.push(r?n.replace(y,"$1"):t||e)})),s}));function L(e){if("string"==typeof e||Y(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function J(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(o);var s=function(){var r=arguments,n=t?t.apply(this,r):r[0],o=s.cache;if(o.has(n))return o.get(n);var i=e.apply(this,r);return s.cache=o.set(n,i),i};return s.cache=new(J.Cache||q),s}J.Cache=q;var W=Array.isArray;function M(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Y(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&S.call(e)==p}var z=function(e,t,s){var r=null==e?void 0:A(e,t);return void 0===r?s:r};function K(e){const s=function(e){const s=t.create({baseURL:e.baseUrl});return s.interceptors.response.use((e=>{const t=z(e,"headers.otcsticket");return t&&(s.defaults.headers.common.OTCSTicket=t),e}),(e=>Promise.reject(e))),s}(e),n=e.username,o=e.password,i=e.otcsticket;if(i)s.defaults.headers.common.OTCSTicket=i;else{if(!n||!o)throw Error("You must provide an otcsticket or username and password.");s.interceptors.request.use((async s=>{if(s.headers.common.OTCSTicket)return s;{const i=r.createFormData();i.append("username",n),i.append("password",o);const a=await t.post(`${e.baseUrl}/api/v1/auth/`,i);return s.headers.common.OTCSTicket=z(a,"data.ticket"),s}}))}return s}class X{_session;constructor(e){this._session=new WeakRef(e)}get session(){return this._session.deref()}}class Z extends X{auth(){return this.session.get("/api/v1/auth/")}}var ee=144,te=0,se=2;class re extends X{addablenodetypes(e){return this.session.get(`api/v1/nodes/${e}/addablenodetypes`)}async addDocument({parent_id:e,fileHandler:t,apiVersion:s="v1",name:r=null,options:n={}}){console.assert(null!=e,"parent_id cannot be null"),console.assert(null!=t,"fileHandler cannot be null"),console.assert(["v1","v2"].includes(s),"apiVersion must be in ['v1','v2']");const o=`api/${s}/nodes`;{const s=r||t.name,i={...n,type:ee,name:s,parent_id:e,file:{file:t,name:s}};return this.session.postForm(o,i)}}async addDocumentMajor({parent_id:e,fileHandler:t,name:s=null,description:r=null,options:n={}}){const o=await this.addDocument({parent_id:e,fileHandler:t,name:s,options:{...n,advanced_versioning:!0}}),i=o.data.id;return await this.session.versions.promote({dataid:i,versionNumber:1,description:r}),await this.session.versions.deleteVersion({dataid:i,versionNumber:1}),o}addItem(e,t,s,r={}){return this.session.postBody("api/v2/nodes",{type:e,parent_id:t,name:s,...r})}node({dataid:e,apiVersion:t="v2",params:s={}}){return this.session.get(`api/${t}/nodes/${e}`,{params:s})}ancestors(e,t={}){return this.session.get(`api/v1/nodes/${e}/ancestors`,{params:t})}volumeInfo(e){return this.session.get(`api/v1/volumes/${e}`)}volumes(){return this.session.get("api/v2/volumes")}addFolder(e,t,s={}){return this.addItem(te,e,t,s)}addGeneration(e,t,s,r,n={}){return this.addItem(se,e,t,{original_id:s,version_number:r,...n})}nodes(e,t={}){return this.session.get(`api/v2/nodes/${e}/nodes`,{params:t})}children(e,t={}){return this.nodes(e,t)}delete(e){return this.session.delete(`api/v1/nodes/${e}`)}download({dataid:e,apiVersion:t="v1",filePath:s}){return Promise.reject("Not implemented yet")}audit({dataid:e,apiVersion:t="v2",params:s={}}){return this.session.get(`api/${t}/nodes/${e}/audit`,{params:s})}}class ne extends X{start(e){return this.draftprocesses(e).then((e=>z(e,"data.results.draftprocess_id"))).then((e=>this.draftprocesses_update(e)))}draftprocesses(e){return this.session.postForm("api/v2/draftprocesses",{workflow_id:e})}draftprocesses_update(e){return this.session.get("api/v1/forms/draftprocesses/update",{params:{draftprocess_id:e}})}draftprocesses_put(e,t){return this.session.putForm(`api/v2/draftprocesses/${e}`,{body:t})}}class oe extends X{scriptNode(e,t={}){return this.session.get(`api/v1/rhcore/${e}`,{params:t})}}class ie extends X{search(e,t={}){return this.session.postBody("api/v2/search",{where:e,...t})}regions(e={}){return this.session.get("api/v1/regions",e)}}class ae extends X{USER;GROUP;constructor(e){super(e),this.USER=0,this.GROUP=1}userQuery(e,t={},s="v2"){const r={limit:20,where_type:JSON.stringify([this.USER,this.GROUP]),query:e,...t};return this.session.get(`api/${s}/members`,{params:r})}member(e,t="v2"){return this.session.get(`api/${t}/members/${e}`)}}class ue extends X{async addVersion({dataid:e,fileHandler:t,apiVersion:s="v1",fileName:r=null,options:n={}}){console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"fileHandler cannot be null");const o=`api/${s}/nodes/${e}/versions`;{const e={file:{file:t,name:r||t.name},...n};return this.session.postForm(o,e)}}async download({dataid:e,version:t,filePath:s}){return console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"version cannot be null"),console.assert(null!=s,"filePath cannot be null"),Promise.reject("Not implemented yet")}async list(e){const t=`api/v1/nodes/${e}/versions`;return this.session.get(t)}async version(e,t="latest"){const s=`api/v1/nodes/${e}/versions/${t}`;return this.session.get(s)}async promote({dataid:e,versionNumber:t,description:s=null}){console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"number_to_keep must be an integer");const r=`api/v2/nodes/${e}/versions/${t}/promote`;return this.session.postBody(r,{...!!s&&{description:s}})}async deleteVersion({dataid:e,versionNumber:t,apiVersion:s="v1"}){console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"number_to_keep must be an integer");const r=`api/${s}/nodes/${e}/versions/${t}`;return this.session.delete(r)}async purge({dataid:e,number_to_keep:t=1}){console.assert(null!=e,"dataid cannot be null"),console.assert(!isNaN(t),"number_to_keep must be an integer");const s=`api/v2/nodes/${e}/versions`;return this.session.deleteForm(s,{number_to_keep:t})}}class ce extends X{run(e,t={}){const s=`api/v1/nodes/${e}/output`;return this.session.get(s,{params:t})}}var pe=function(e){return null==e};const de={code:-32603,message:"Internal error"};class le extends Error{code;data;constructor(e=de.message,t=null,s=de.code){if("object"==typeof(r=e)&&null!==r){const t=e;super(t.message),this.code=t.code,this.data=t.data}else super(e),this.code=s,this.data=t;var r}}const he={index:0,get next(){return this.index=this.index+1,this.index}};class fe{session;relativePath;_batchQueue;constructor(e,t){this.session=e,this.relativePath=t,this.resetQueue()}requestObject(e,t,s){return{jsonrpc:"2.0",method:e,id:s,params:t}}handleResponse(e){if(Object.prototype.hasOwnProperty.call(e,"result"))return e.result;if(Object.prototype.hasOwnProperty.call(e,"error")){const t=e.error;throw new le(t.message,t.data,t.code)}throw Error("The server did not respond correctly.")}async request(e,t,s=he.next){const r=await this.session.postBody(this.relativePath,{rpc:this.requestObject(e,t,s)});return this.handleResponse(r.data)}resetQueue(){this._batchQueue=[]}queue(e,t,s=he.next){return this._batchQueue.push(this.requestObject(e,t,s)),this}async batch(e=!1){const t=this._batchQueue;this.resetQueue();const s=await this.session.postBody(this.relativePath,{rpc:t});return z(s,"data.data",[]).map((t=>{if(e)return this.handleResponse(t);try{return this.handleResponse(t)}catch(e){return e}}))}rhnode(e,t,s=[],r=he.next){const n={dataid:e,args:s};return this.request(t,n,r)}rhnodeQueue(e,t,s=[],r=he.next){const n={dataid:e,args:s};return this.queue(t,n,r)}}e.Session=class{axios;_nodes;_auth;_workflow;_rhcore;_members;_search;_webreports;_versions;constructor(e){this.axios=K(e)}get nodes(){return null==this._nodes&&(this._nodes=new re(this)),this._nodes}get auth(){return null==this._auth&&(this._auth=new Z(this)),this._auth}get workflow(){return null==this._workflow&&(this._workflow=new ne(this)),this._workflow}get rhcore(){return null==this._rhcore&&(this._rhcore=new oe(this)),this._rhcore}get members(){return null==this._members&&(this._members=new ae(this)),this._members}get search(){return null==this._search&&(this._search=new ie(this)),this._search}get webreports(){return null==this._webreports&&(this._webreports=new ce(this)),this._webreports}get versions(){return null==this._versions&&(this._versions=new ue(this)),this._versions}get dataTypesEnum(){return s}rpcClient(e="/api/v1/rh/rpc/rhnode/"){return new fe(this,e)}_isObject(e){return e&&"object"==typeof e&&e.constructor===Object}_isString(e){return"string"==typeof e||e instanceof String}_isBoolean(e){return"boolean"==typeof e}objectToForm(e){const t=r.createFormData();for(const[s,r]of Object.entries(e))r&&r.name&&r.file?t.append(s,r.file,r.name):Array.isArray(r)||this._isObject(r)||this._isBoolean(r)?t.append(s,JSON.stringify(r)):pe(r)||t.append(s,r);return t}putForm(e,t){const s=this.objectToForm(t);return this.put(e,s)}postForm(e,t){const s=this.objectToForm(t);return this.post(e,s,{maxBodyLength:1/0})}patchForm(e,t){const s=this.objectToForm(t);return this.patch(e,s)}deleteForm(e,t){return this.delete(e)}putBody(e,t){return this.putForm(e,{body:t})}postBody(e,t){return this.postForm(e,{body:t})}patchBody(e,t){return this.patchForm(e,{body:t})}deleteBody(e,t){return this.deleteForm(e,{body:t})}get(e,t){return this.axios.get(e,t)}post(e,t,s){return this.axios.post(e,t,s)}put(e,t,s){return this.axios.put(e,t,s)}patch(e,t,s){return this.axios.patch(e,t,s)}options(e,t){return this.axios.options(e,t)}delete(e,t){return this.axios.delete(e,t)}}}));
//# sourceMappingURL=index.umd.min.js.map
