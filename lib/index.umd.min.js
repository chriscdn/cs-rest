!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios")):"function"==typeof define&&define.amd?define(["exports","axios"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CSREST={},e.axios)}(this,(function(e,t){"use strict";var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n=r((function(e){return"object"==typeof e&&null!==e})),o=Object.defineProperty,i=(e,t,s)=>(((e,t,s)=>{t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const a={code:-32603,message:"Internal error"};class u extends Error{constructor(e=a.message,t=null,s=a.code){var r=(...e)=>(super(...e),i(this,"code"),i(this,"data"),this);if(n(e)){const t=e;r(t.message),this.code=t.code,this.data=t.data}else r(e),this.code=s,this.data=t}}var c={AssocType:-18,BooleanType:5,ClassType:9,DapiNodeType:-72,DapiSessionType:-74,DapiStreamType:-68,DapiVersionType:-69,DateType:-7,DynamicType:-127,ErrorType:1,FileType:-107,FrameType:10,IntegerType:2,JavaObjectType:-42,ListType:-2,LongType:-8,ObjectType:-128,ObjRefType:3,RealType:-4,RecArrayType:-110,RecordType:-109,ScriptType:-3,SocketType:-102,StringType:-1,UAPIType:-196,UndefinedType:0,VoidType:8,WAPIWorkType:-75},l={createFormData:()=>new FormData},d="__lodash_hash_undefined__",p=1/0,h="[object Function]",f="[object GeneratorFunction]",y="[object Symbol]",m=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_=/^\w*$/,b=/^\./,v=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,w=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,T="object"==typeof s&&s&&s.Object===Object&&s,j="object"==typeof self&&self&&self.Object===Object&&self,O=T||j||Function("return this")();var k,P=Array.prototype,$=Function.prototype,x=Object.prototype,F=O["__core-js_shared__"],S=(k=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"",I=$.toString,R=x.hasOwnProperty,U=x.toString,A=RegExp("^"+I.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),E=O.Symbol,C=P.splice,B=M(O,"Map"),D=M(Object,"create"),N=E?E.prototype:void 0,V=N?N.toString:void 0;function q(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function Q(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function H(e){var t=-1,s=e?e.length:0;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}function W(e,t){for(var s,r,n=e.length;n--;)if((s=e[n][0])===(r=t)||s!=s&&r!=r)return n;return-1}function G(e,t){var s;t=function(e,t){if(X(e))return!1;var s=typeof e;if("number"==s||"symbol"==s||"boolean"==s||null==e||ee(e))return!0;return _.test(e)||!m.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:X(s=t)?s:z(s);for(var r=0,n=t.length;null!=e&&r<n;)e=e[Y(t[r++])];return r&&r==n?e:void 0}function L(e){if(!Z(e)||(t=e,S&&S in t))return!1;var t,s=function(e){var t=Z(e)?U.call(e):"";return t==h||t==f}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?A:g;return s.test(function(e){if(null!=e){try{return I.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function J(e,t){var s,r,n=e.__data__;return("string"==(r=typeof(s=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==s:null===s)?n["string"==typeof t?"string":"hash"]:n.map}function M(e,t){var s=function(e,t){return null==e?void 0:e[t]}(e,t);return L(s)?s:void 0}q.prototype.clear=function(){this.__data__=D?D(null):{}},q.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},q.prototype.get=function(e){var t=this.__data__;if(D){var s=t[e];return s===d?void 0:s}return R.call(t,e)?t[e]:void 0},q.prototype.has=function(e){var t=this.__data__;return D?void 0!==t[e]:R.call(t,e)},q.prototype.set=function(e,t){return this.__data__[e]=D&&void 0===t?d:t,this},Q.prototype.clear=function(){this.__data__=[]},Q.prototype.delete=function(e){var t=this.__data__,s=W(t,e);return!(s<0)&&(s==t.length-1?t.pop():C.call(t,s,1),!0)},Q.prototype.get=function(e){var t=this.__data__,s=W(t,e);return s<0?void 0:t[s][1]},Q.prototype.has=function(e){return W(this.__data__,e)>-1},Q.prototype.set=function(e,t){var s=this.__data__,r=W(s,e);return r<0?s.push([e,t]):s[r][1]=t,this},H.prototype.clear=function(){this.__data__={hash:new q,map:new(B||Q),string:new q}},H.prototype.delete=function(e){return J(this,e).delete(e)},H.prototype.get=function(e){return J(this,e).get(e)},H.prototype.has=function(e){return J(this,e).has(e)},H.prototype.set=function(e,t){return J(this,e).set(e,t),this};var z=K((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(ee(e))return V?V.call(e):"";var t=e+"";return"0"==t&&1/e==-p?"-0":t}(t);var s=[];return b.test(e)&&s.push(""),e.replace(v,(function(e,t,r,n){s.push(r?n.replace(w,"$1"):t||e)})),s}));function Y(e){if("string"==typeof e||ee(e))return e;var t=e+"";return"0"==t&&1/e==-p?"-0":t}function K(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var s=function(){var r=arguments,n=t?t.apply(this,r):r[0],o=s.cache;if(o.has(n))return o.get(n);var i=e.apply(this,r);return s.cache=o.set(n,i),i};return s.cache=new(K.Cache||H),s}K.Cache=H;var X=Array.isArray;function Z(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ee(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&U.call(e)==y}var te=r((function(e,t,s){var r=null==e?void 0:G(e,t);return void 0===r?s:r}));const se=e=>{const s=(e=>{const s=t.create({baseURL:e.baseUrl,paramsSerializer:{indexes:null}});return s.interceptors.response.use((e=>{const t=te(e,"headers.otcsticket");return t&&(s.defaults.headers.common.OTCSTicket=t),e}),(e=>Promise.reject(e))),s})(e),r=e.username,n=e.password,o=e.otcsticket;if(o)s.defaults.headers.common.OTCSTicket=o;else{if(!r||!n)throw Error("You must provide an otcsticket or username and password.");s.interceptors.request.use((async s=>{if(s.headers.common?.OTCSTicket)return s;{const o=l.createFormData();o.append("username",r),o.append("password",n);const i=await t.post(`${e.baseUrl}/api/v1/auth/`,o);return s.headers.OTCSTicket=te(i,"data.ticket"),s}}))}return s};var re=Object.defineProperty,ne=(e,t,s)=>(((e,t,s)=>{t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,t+"",s),s);class oe{constructor(e){ne(this,"_session"),this._session=new WeakRef(e)}get session(){return this._session.deref()}}class ie extends oe{auth(){return this.session.get("/api/v1/auth/")}}var ae=144,ue=0,ce=2;class le extends oe{addablenodetypes(e){return this.session.get(`api/v1/nodes/${e}/addablenodetypes`)}async addDocument({parent_id:e,fileHandler:t,apiVersion:s="v1",name:r=null,options:n={}}){console.assert(null!=e,"parent_id cannot be null"),console.assert(null!=t,"fileHandler cannot be null"),console.assert(["v1","v2"].includes(s),"apiVersion must be in ['v1','v2']");const o=`api/${s}/nodes`;{const s=r||t.name,i={...n,type:ae,name:s,parent_id:e,file:{file:t,name:s}};return this.session.postForm(o,i)}}async addDocumentMajor({parent_id:e,fileHandler:t,name:s=null,description:r=null,options:n={}}){const o=await this.addDocument({parent_id:e,fileHandler:t,name:s,options:{...n,advanced_versioning:!0}}),i=o.data.id;return await this.session.versions.promote({dataid:i,versionNumber:1,description:r}),await this.session.versions.deleteVersion({dataid:i,versionNumber:1}),o}addItem(e,t,s,r={}){return this.session.postBody("api/v2/nodes",{type:e,parent_id:t,name:s,...r})}node({dataid:e,apiVersion:t="v2",params:s={}}){return this.session.get(`api/${t}/nodes/${e}`,{params:s})}ancestors(e,t={}){return this.session.get(`api/v1/nodes/${e}/ancestors`,{params:t})}volumeInfo(e){return this.session.get(`api/v1/volumes/${e}`)}volumes(){return this.session.get("api/v2/volumes")}addFolder(e,t,s={}){return this.addItem(ue,e,t,s)}addGeneration(e,t,s,r,n={}){return this.addItem(ce,e,t,{original_id:s,version_number:r,...n})}nodes(e,t={}){return this.session.get(`api/v2/nodes/${e}/nodes`,{params:t})}children(e,t={}){return this.nodes(e,t)}delete(e){return this.session.delete(`api/v1/nodes/${e}`)}download({dataid:e,apiVersion:t="v1",filePath:s}){return Promise.reject("Not implemented yet")}audit({dataid:e,apiVersion:t="v2",params:s={}}){return this.session.get(`api/${t}/nodes/${e}/audit`,{params:s})}}var de=Object.defineProperty,pe=(e,t,s)=>(((e,t,s)=>{t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,t+"",s),s);class he{constructor(e,t){this.session=e,this.mapId=t,pe(this,"workflowPropertiesInfo",null)}async start(){this.workflowPropertiesInfo=await this.session.workflow.start(this.mapId)}get form(){return this.workflowPropertiesInfo.forms[0]}findWorkflowAttribute(e){const t=this.form.schema.properties;return Object.entries(t).find((([t,s])=>s.title===e))}get processId(){return this.workflowPropertiesInfo.data.process_id}get attachmentsFolderId(){const e=this.workflowPropertiesInfo.data.data_packages.find((e=>1===e.type&&1===e.sub_type));return e?.data.attachment_folder_id}get wantComments(){return this.workflowPropertiesInfo.data.comments_on}get wantAuthentication(){return this.workflowPropertiesInfo.data.authentication}setWorkflowAttribute(e,t){const[s,r]=this.findWorkflowAttribute(e)??[];if("array"===r.type===Array.isArray(t))return this.form.data[s]=t,he;throw new Error("Invalid type.")}async formUpdate(){return await this.session.workflow.draftprocessesPut(this.processId,{action:"formUpdate",values:this.form.data})}async initiate({comment:e,password:t}={}){await this.formUpdate();const s={action:"Initiate",...this.wantComments&&{comment:e},...this.wantAuthentication&&{authentication_info:{password:t}}};return await this.session.workflow.draftprocessesPut(this.processId,s)}}class fe extends oe{workflowInitiator(e){return new he(this._session.deref(),e)}start(e){return this.draftprocesses(e).then((e=>e.results.draftprocess_id)).then((e=>this.draftprocessesUpdate(e)))}async draftprocesses(e){const{data:t}=await this.session.postForm("api/v2/draftprocesses",{workflow_id:e});return t}async draftprocessesUpdate(e){const{data:t}=await this.session.get("api/v1/forms/draftprocesses/update",{params:{draftprocess_id:e}});return t}async draftprocessesPut(e,t){const{data:s}=await this.session.putForm(`api/v2/draftprocesses/${e}`,{body:t});return s}}class ye extends oe{scriptNode(e,t={}){return this.session.postForm(`api/v1/rhcore/${e}`,t)}}class me extends oe{search(e,t={}){return this.session.postBody("api/v2/search",{where:e,...t})}regions(e={}){return this.session.get("api/v1/regions",e)}}var _e=Object.defineProperty,be=(e,t,s)=>(((e,t,s)=>{t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);class ve extends oe{constructor(e){super(e),be(this,"USER"),be(this,"GROUP"),this.USER=0,this.GROUP=1}userQuery(e,t={},s="v2"){const r={limit:20,where_type:JSON.stringify([this.USER,this.GROUP]),query:e,...t};return this.session.get(`api/${s}/members`,{params:r})}member(e,t="v2"){return this.session.get(`api/${t}/members/${e}`)}}class we extends oe{async addVersion({dataid:e,fileHandler:t,apiVersion:s="v1",fileName:r=null,options:n={}}){console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"fileHandler cannot be null");const o=`api/${s}/nodes/${e}/versions`;{const e={file:{file:t,name:r||t.name},...n};return this.session.postForm(o,e)}}async download({dataid:e,version:t,filePath:s}){return console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"version cannot be null"),console.assert(null!=s,"filePath cannot be null"),Promise.reject("Not implemented yet")}async list(e){const t=`api/v1/nodes/${e}/versions`;return this.session.get(t)}async version(e,t="latest"){const s=`api/v1/nodes/${e}/versions/${t}`;return this.session.get(s)}async promote({dataid:e,versionNumber:t,description:s=null}){console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"number_to_keep must be an integer");const r=`api/v2/nodes/${e}/versions/${t}/promote`;return this.session.postBody(r,{...!!s&&{description:s}})}async deleteVersion({dataid:e,versionNumber:t,apiVersion:s="v1"}){console.assert(null!=e,"dataid cannot be null"),console.assert(null!=t,"number_to_keep must be an integer");const r=`api/${s}/nodes/${e}/versions/${t}`;return this.session.delete(r)}async purge({dataid:e,number_to_keep:t=1}){console.assert(null!=e,"dataid cannot be null"),console.assert(!isNaN(t),"number_to_keep must be an integer");const s=`api/v2/nodes/${e}/versions`;return this.session.deleteForm(s,{number_to_keep:t})}}class ge extends oe{run(e,t={}){const s=`api/v1/nodes/${e}/output`;return this.session.get(s,{params:t})}}var Te=r((function(e){return null==e})),je=Object.defineProperty,Oe=(e,t,s)=>(((e,t,s)=>{t in e?je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);const ke={index:0,get next(){return this.index=this.index+1,this.index}};class Pe{constructor(e,t){Oe(this,"session"),Oe(this,"relativePath"),Oe(this,"_batchQueue"),this.session=e,this.relativePath=t,this.resetQueue()}requestObject(e,t,s){return{jsonrpc:"2.0",method:e,id:s,params:t}}handleResponse(e){if(Object.prototype.hasOwnProperty.call(e,"result"))return e.result;if(Object.prototype.hasOwnProperty.call(e,"error")){const t=e.error;throw new u(t.message,t.data,t.code)}throw Error("The server did not respond correctly.")}async request(e,t,s=ke.next){const r=await this.session.postBody(this.relativePath,{rpc:this.requestObject(e,t,s)});return this.handleResponse(r.data)}resetQueue(){this._batchQueue=[]}queue(e,t,s=ke.next){return this._batchQueue.push(this.requestObject(e,t,s)),this}async batch(e=!1){const t=this._batchQueue;this.resetQueue();const s=await this.session.postBody(this.relativePath,{rpc:t});return te(s,"data.data",[]).map((t=>{if(e)return this.handleResponse(t);try{return this.handleResponse(t)}catch(e){return e}}))}rhnode(e,t,s=[],r=ke.next){const n={dataid:e,args:s};return this.request(t,n,r)}rhnodeQueue(e,t,s=[],r=ke.next){const n={dataid:e,args:s};return this.queue(t,n,r)}}var $e=Object.defineProperty,xe=(e,t,s)=>(((e,t,s)=>{t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);e.RPCError=u,e.Session=class{constructor(e){xe(this,"axios"),xe(this,"_nodes"),xe(this,"_auth"),xe(this,"_workflow"),xe(this,"_rhcore"),xe(this,"_members"),xe(this,"_search"),xe(this,"_webreports"),xe(this,"_versions"),xe(this,"baseUrl"),this.baseUrl=e.baseUrl,this.axios=se(e)}get nodes(){return null==this._nodes&&(this._nodes=new le(this)),this._nodes}get auth(){return null==this._auth&&(this._auth=new ie(this)),this._auth}get workflow(){return null==this._workflow&&(this._workflow=new fe(this)),this._workflow}get rhcore(){return null==this._rhcore&&(this._rhcore=new ye(this)),this._rhcore}get members(){return null==this._members&&(this._members=new ve(this)),this._members}get search(){return null==this._search&&(this._search=new me(this)),this._search}get webreports(){return null==this._webreports&&(this._webreports=new ge(this)),this._webreports}get versions(){return null==this._versions&&(this._versions=new we(this)),this._versions}get dataTypesEnum(){return c}rpcClient(e="/api/v1/rh/rpc/rhnode/"){return new Pe(this,e)}_isObject(e){return e&&"object"==typeof e&&e.constructor===Object}_isString(e){return"string"==typeof e||e instanceof String}_isBoolean(e){return"boolean"==typeof e}objectToForm(e){const t=l.createFormData();for(const[s,r]of Object.entries(e))r&&r.name&&r.file?t.append(s,r.file,r.name):Array.isArray(r)||this._isObject(r)||this._isBoolean(r)?t.append(s,JSON.stringify(r)):Te(r)||t.append(s,r);return t}putForm(e,t){const s=this.objectToForm(t);return this.put(e,s)}postForm(e,t){const s=this.objectToForm(t);return this.post(e,s,{maxBodyLength:1/0})}patchForm(e,t){const s=this.objectToForm(t);return this.patch(e,s)}deleteForm(e,t){return this.delete(e)}putBody(e,t){return this.putForm(e,{body:t})}postBody(e,t){return this.postForm(e,{body:t})}patchBody(e,t){return this.patchForm(e,{body:t})}deleteBody(e,t){return this.deleteForm(e,{body:t})}get(e,t){return this.axios.get(e,t)}post(e,t,s){return this.axios.post(e,t,s)}put(e,t,s){return this.axios.put(e,t,s)}patch(e,t,s){return this.axios.patch(e,t,s)}options(e,t){return this.axios.options(e,t)}delete(e,t){return this.axios.delete(e,t)}async $get(e,t){return(await this.get(e,t)).data}},e.isRPCError=e=>void 0!==e.code&&void 0!==e.data}));
//# sourceMappingURL=index.umd.min.js.map
